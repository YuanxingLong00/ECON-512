%% series estimation linear for muwip0 and muwip1
% treated=find(W);
% control=find(W0);
% sizet=size(treated);
% sizec=size(control);
% pXhattempt=[ones(sizet(1),1) pXhattemp(treated)];
% pXhattempc=[ones(sizec(1),1) pXhattemp(control)];
% pXexpand= [ones(N,1) pXhattemp];
% pXpXt= pXhattempt'*pXhattempt;
% pXpXc= pXhattempc'*pXhattempc;
% beta1= pXpXt\pXhattempt'*Y(treated);
% beta0= pXpXc\pXhattempc'*Y(control);
% muwip1= pXexpand* beta1;
% muwip0= pXexpand* beta0;
pXhreg=[W pXhattemp];
pXpX=pXhreg'*pXhreg;
beta= pXpX\pXhreg'*Y;
pXhreg1=[ones(N,1) pXhattemp];
pXhreg0=[zeros(N,1) pXhattemp];
muwip1=pXhreg1*beta;
muwip0=pXhreg0*beta;
